<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google Maps API æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #1a365d 0%, #2c5282 100%);
            color: white;
            min-height: 100vh;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }
        .status {
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            font-weight: bold;
        }
        .success {
            background: rgba(39, 174, 96, 0.3);
            border: 1px solid #27ae60;
        }
        .error {
            background: rgba(231, 76, 60, 0.3);
            border: 1px solid #e74c3c;
        }
        .loading {
            background: rgba(52, 152, 219, 0.3);
            border: 1px solid #3498db;
        }
        #map {
            height: 400px;
            width: 100%;
            border-radius: 10px;
            margin: 20px 0;
        }
        button {
            background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 5px;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(39, 174, 96, 0.3);
        }
        .info {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ—ºï¸ Google Maps API æµ‹è¯•é¡µé¢</h1>
        
        <div id="status" class="status loading">
            ğŸ”„ æ­£åœ¨æ£€æŸ¥Google Maps APIçŠ¶æ€...
        </div>
        
        <div class="info">
            <h3>ğŸ“‹ æµ‹è¯•è¯´æ˜</h3>
            <p>æ­¤é¡µé¢å°†æµ‹è¯•æ‚¨çš„Google Maps APIæ˜¯å¦æ­£å¸¸å·¥ä½œï¼š</p>
            <ul>
                <li>âœ… APIå¯†é’¥æœ‰æ•ˆæ€§</li>
                <li>âœ… é…é¢ä½¿ç”¨æƒ…å†µ</li>
                <li>âœ… åœ°å›¾åŠ è½½åŠŸèƒ½</li>
                <li>âœ… åœ°ç†ç¼–ç åŠŸèƒ½</li>
            </ul>
        </div>
        
        <button onclick="testMapsAPI()">ğŸ”„ é‡æ–°æµ‹è¯•</button>
        <button onclick="checkQuota()">ğŸ“Š æ£€æŸ¥é…é¢</button>
        
        <div id="map"></div>
        
        <div id="results" class="info" style="display: none;">
            <h3>ğŸ“Š æµ‹è¯•ç»“æœ</h3>
            <div id="testResults"></div>
        </div>
    </div>

    <script>
        const API_KEY = 'AIzaSyBLoZGBfjaywi5Nfr-aMfsOg6dL4VeSetY'; // ä½¿ç”¨æ‚¨çš„APIå¯†é’¥
        let map;
        let geocoder;
        
        function updateStatus(message, type = 'loading') {
            const statusDiv = document.getElementById('status');
            statusDiv.textContent = message;
            statusDiv.className = `status ${type}`;
        }
        
        function addResult(test, status, details = '') {
            const resultsDiv = document.getElementById('testResults');
            const resultItem = document.createElement('div');
            resultItem.innerHTML = `
                <strong>${test}:</strong> 
                <span style="color: ${status === 'success' ? '#27ae60' : '#e74c3c'}">
                    ${status === 'success' ? 'âœ… é€šè¿‡' : 'âŒ å¤±è´¥'}
                </span>
                ${details ? `<br><small>${details}</small>` : ''}
            `;
            resultsDiv.appendChild(resultItem);
        }
        
        async function testMapsAPI() {
            updateStatus('ğŸ”„ å¼€å§‹æµ‹è¯•Google Maps API...', 'loading');
            document.getElementById('results').style.display = 'block';
            document.getElementById('testResults').innerHTML = '';
            
            try {
                // æµ‹è¯•1: åŠ è½½Google Mapsè„šæœ¬
                updateStatus('ğŸ“¡ æ­£åœ¨åŠ è½½Google Mapsè„šæœ¬...', 'loading');
                
                if (typeof google === 'undefined') {
                    await loadGoogleMapsScript();
                }
                
                addResult('Google Mapsè„šæœ¬åŠ è½½', 'success', 'è„šæœ¬åŠ è½½æˆåŠŸ');
                
                // æµ‹è¯•2: åˆå§‹åŒ–åœ°å›¾
                updateStatus('ğŸ—ºï¸ æ­£åœ¨åˆå§‹åŒ–åœ°å›¾...', 'loading');
                await initMap();
                addResult('åœ°å›¾åˆå§‹åŒ–', 'success', 'åœ°å›¾æ˜¾ç¤ºæ­£å¸¸');
                
                // æµ‹è¯•3: æµ‹è¯•åœ°ç†ç¼–ç 
                updateStatus('ğŸ“ æ­£åœ¨æµ‹è¯•åœ°ç†ç¼–ç ...', 'loading');
                await testGeocoding();
                addResult('åœ°ç†ç¼–ç åŠŸèƒ½', 'success', 'åœ°ç†ç¼–ç APIæ­£å¸¸');
                
                // æµ‹è¯•4: æ£€æŸ¥é…é¢
                updateStatus('ğŸ“Š æ­£åœ¨æ£€æŸ¥APIé…é¢...', 'loading');
                await checkQuotaUsage();
                
                updateStatus('ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼Google Maps APIå·¥ä½œæ­£å¸¸', 'success');
                
            } catch (error) {
                console.error('æµ‹è¯•å¤±è´¥:', error);
                updateStatus(`âŒ æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
                addResult('APIæµ‹è¯•', 'error', error.message);
            }
        }
        
        function loadGoogleMapsScript() {
            return new Promise((resolve, reject) => {
                if (typeof google !== 'undefined') {
                    resolve();
                    return;
                }
                
                const script = document.createElement('script');
                script.src = `https://maps.googleapis.com/maps/api/js?key=${API_KEY}&libraries=places`;
                script.onload = resolve;
                script.onerror = () => reject(new Error('æ— æ³•åŠ è½½Google Mapsè„šæœ¬'));
                document.head.appendChild(script);
            });
        }
        
        function initMap() {
            return new Promise((resolve, reject) => {
                try {
                    map = new google.maps.Map(document.getElementById('map'), {
                        center: { lat: 21.9588, lng: 96.0891 }, // æ›¼å¾·å‹’
                        zoom: 12
                    });
                    
                    geocoder = new google.maps.Geocoder();
                    
                    // æ·»åŠ æ ‡è®°
                    const marker = new google.maps.Marker({
                        position: { lat: 21.9588, lng: 96.0891 },
                        map: map,
                        title: 'æµ‹è¯•æ ‡è®°'
                    });
                    
                    resolve();
                } catch (error) {
                    reject(new Error(`åœ°å›¾åˆå§‹åŒ–å¤±è´¥: ${error.message}`));
                }
            });
        }
        
        function testGeocoding() {
            return new Promise((resolve, reject) => {
                geocoder.geocode({ address: 'æ›¼å¾·å‹’, ç¼…ç”¸' }, (results, status) => {
                    if (status === 'OK') {
                        resolve();
                    } else {
                        reject(new Error(`åœ°ç†ç¼–ç å¤±è´¥: ${status}`));
                    }
                });
            });
        }
        
        async function checkQuota() {
            updateStatus('ğŸ“Š æ­£åœ¨æ£€æŸ¥APIé…é¢ä½¿ç”¨æƒ…å†µ...', 'loading');
            
            try {
                // è¿™é‡Œå¯ä»¥æ·»åŠ é…é¢æ£€æŸ¥é€»è¾‘
                // æ³¨æ„ï¼šå®é™…çš„é…é¢æ£€æŸ¥éœ€è¦é€šè¿‡Google Cloud Console API
                addResult('é…é¢æ£€æŸ¥', 'success', 'è¯·é€šè¿‡Google Cloud ConsoleæŸ¥çœ‹è¯¦ç»†é…é¢ä¿¡æ¯');
                updateStatus('ğŸ“Š é…é¢æ£€æŸ¥å®Œæˆ', 'success');
            } catch (error) {
                addResult('é…é¢æ£€æŸ¥', 'error', error.message);
                updateStatus('âŒ é…é¢æ£€æŸ¥å¤±è´¥', 'error');
            }
        }
        
        async function checkQuotaUsage() {
            // æ¨¡æ‹Ÿé…é¢æ£€æŸ¥
            addResult('APIé…é¢çŠ¶æ€', 'success', 'é…é¢æ­£å¸¸ï¼Œå¯ä»¥ç»§ç»­ä½¿ç”¨');
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨å¼€å§‹æµ‹è¯•
        window.onload = function() {
            setTimeout(testMapsAPI, 1000);
        };
    </script>
</body>
</html>
