# MARKET LINK EXPRESS - AI å¼€å‘æŒ‡å—

## ğŸ“‹ é¡¹ç›®æ¦‚è§ˆ

MARKET LINK EXPRESS æ˜¯ä¸€ä¸ªå®Œæ•´çš„å¿«é€’ç®¡ç†ç³»ç»Ÿï¼ŒåŒ…å«ä¸‰ä¸ªä¸»è¦ç»„ä»¶ï¼š

### ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MARKET LINK EXPRESS                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Web ç®¡ç†åå° (React + TypeScript)                      â”‚
â”‚     â”œâ”€â”€ å®¢æˆ·ä¸‹å•é¡µé¢                                        â”‚
â”‚     â”œâ”€â”€ å®æ—¶è·Ÿè¸ªç®¡ç†                                        â”‚
â”‚     â”œâ”€â”€ å¿«é€’å‘˜ç®¡ç†                                          â”‚
â”‚     â””â”€â”€ åŒ…è£¹ç®¡ç†                                           â”‚
â”‚     ğŸŒ éƒ¨ç½²: Netlify (ä¸»è¦) + Vercel (å¤‡ç”¨)                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  2. å®¢æˆ·ç«¯ APP (React Native + Expo)                       â”‚
â”‚     â”œâ”€â”€ å®¢æˆ·ä¸‹å•                                            â”‚
â”‚     â”œâ”€â”€ åŒ…è£¹è·Ÿè¸ª                                            â”‚
â”‚     â””â”€â”€ è®¢å•ç®¡ç†                                            â”‚
â”‚     ğŸ“± éƒ¨ç½²: Expo EAS Build                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  3. å‘˜å·¥ APP (React Native + Expo)                         â”‚
â”‚     â”œâ”€â”€ éª‘æ‰‹ç™»å½•                                            â”‚
â”‚     â”œâ”€â”€ ä»»åŠ¡ç®¡ç†                                            â”‚
â”‚     â”œâ”€â”€ åœ°å›¾å¯¼èˆª                                            â”‚
â”‚     â””â”€â”€ åŒ…è£¹æ‰«æ                                            â”‚
â”‚     ğŸ“± éƒ¨ç½²: Expo EAS Build                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  4. æ•°æ®åº“ (Supabase PostgreSQL)                          â”‚
â”‚     â”œâ”€â”€ packages (åŒ…è£¹è¡¨)                                  â”‚
â”‚     â”œâ”€â”€ couriers (å¿«é€’å‘˜è¡¨)                                â”‚
â”‚     â”œâ”€â”€ users (ç”¨æˆ·è¡¨)                                     â”‚
â”‚     â”œâ”€â”€ admin_accounts (ç®¡ç†å‘˜è´¦å·è¡¨)                      â”‚
â”‚     â””â”€â”€ courier_locations (å¿«é€’å‘˜ä½ç½®è¡¨)                   â”‚
â”‚     ğŸ—„ï¸ æ‰˜ç®¡: Supabase Cloud                               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  5. å¤–éƒ¨æœåŠ¡é›†æˆ                                           â”‚
â”‚     â”œâ”€â”€ Google Maps API (åœ°å›¾æœåŠ¡)                         â”‚
â”‚     â”œâ”€â”€ Google Cloud Console (API ç®¡ç†)                   â”‚
â”‚     â””â”€â”€ GitHub (ä»£ç æ‰˜ç®¡)                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”„ ä¸šåŠ¡æµç¨‹æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    å®¢æˆ·ä¸‹å•æµç¨‹                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸŒ Web åº”ç”¨                                                â”‚
â”‚     â†“                                                       â”‚
â”‚  ğŸ“ å®¢æˆ·æ³¨å†Œ â†’ users è¡¨                                     â”‚
â”‚     â†“                                                       â”‚
â”‚  ğŸ” è‡ªåŠ¨ç™»å½• â†’ èº«ä»½éªŒè¯                                     â”‚
â”‚     â†“                                                       â”‚
â”‚  ğŸ“¦ å¡«å†™è®¢å• â†’ packages è¡¨                                  â”‚
â”‚     â†“                                                       â”‚
â”‚  ğŸ’³ ç”ŸæˆäºŒç»´ç  â†’ æ”¯ä»˜ç¡®è®¤                                   â”‚
â”‚     â†“                                                       â”‚
â”‚  ğŸ†” è‡ªåŠ¨ç”Ÿæˆè®¢å•å· â†’ è¿›å…¥ç³»ç»Ÿ                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    åŒ…è£¹é…é€æµç¨‹                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“‹ åŒåŸåŒ…è£¹é¡µé¢ â†’ æ˜¾ç¤ºå¾…åˆ†é…è®¢å•                           â”‚
â”‚     â†“                                                       â”‚
â”‚  ğŸ‘¨â€ğŸ’¼ ç®¡ç†å‘˜æŸ¥çœ‹ â†’ å®æ—¶è·Ÿè¸ªé¡µé¢                             â”‚
â”‚     â†“                                                       â”‚
â”‚  ğŸ¤– è‡ªåŠ¨åˆ†é… â†’ é€‰æ‹©æœ€ä½³éª‘æ‰‹                                 â”‚
â”‚     â†“                                                       â”‚
â”‚  ğŸ“± éª‘æ‰‹ APP â†’ æ¥æ”¶ä»»åŠ¡é€šçŸ¥                                 â”‚
â”‚     â†“                                                       â”‚
â”‚  ğŸšš éª‘æ‰‹å–ä»¶ â†’ æ›´æ–°çŠ¶æ€ "å·²å–ä»¶"                           â”‚
â”‚     â†“                                                       â”‚
â”‚  ğŸ›£ï¸ éª‘æ‰‹é…é€ â†’ æ›´æ–°çŠ¶æ€ "é…é€ä¸­"                           â”‚
â”‚     â†“                                                       â”‚
â”‚  âœ… éª‘æ‰‹é€è¾¾ â†’ æ›´æ–°çŠ¶æ€ "å·²é€è¾¾"                           â”‚
â”‚     â†“                                                       â”‚
â”‚  ğŸ“¢ å®¢æˆ·é€šçŸ¥ â†’ é€è¾¾ç¡®è®¤                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”— ç³»ç»Ÿè¿æ¥æœºåˆ¶

### 1. å®Œæ•´ä¸šåŠ¡æµç¨‹

#### ğŸ“± å®¢æˆ·ä¸‹å•æµç¨‹
```
1. å®¢æˆ·è®¿é—® Web åº”ç”¨
   â†“
2. ç‚¹å‡»ä¸‹å• â†’ è·³è½¬æ³¨å†Œé¡µé¢
   â†“
3. å¡«å†™æ³¨å†Œä¿¡æ¯ â†’ åˆ›å»ºç”¨æˆ·è´¦å· (users è¡¨)
   â†“
4. æ³¨å†ŒæˆåŠŸ â†’ è‡ªåŠ¨ç™»å½•
   â†“
5. å¡«å†™è®¢å•ä¿¡æ¯ â†’ æäº¤è®¢å•
   â†“
6. ç”Ÿæˆä»˜æ¬¾äºŒç»´ç  â†’ å®¢æˆ·æ‰«ç æ”¯ä»˜
   â†“
7. æ”¯ä»˜æˆåŠŸ â†’ è‡ªåŠ¨ç”Ÿæˆè®¢å•å· â†’ è®¢å•è¿›å…¥ç³»ç»Ÿ
```

#### ğŸšš åŒ…è£¹é…é€æµç¨‹
```
1. è®¢å•è¿›å…¥ "åŒåŸåŒ…è£¹" é¡µé¢
   â†“
2. ç®¡ç†å‘˜æŸ¥çœ‹ "å®æ—¶è·Ÿè¸ª" é¡µé¢
   â†“
3. ç‚¹å‡» "è‡ªåŠ¨åˆ†é…" â†’ åˆ†é…ç»™éª‘æ‰‹
   â†“
4. éª‘æ‰‹ APP æ”¶åˆ°ä»»åŠ¡é€šçŸ¥
   â†“
5. éª‘æ‰‹å–ä»¶ â†’ æ›´æ–°åŒ…è£¹çŠ¶æ€ä¸º "å·²å–ä»¶"
   â†“
6. éª‘æ‰‹é…é€ â†’ æ›´æ–°åŒ…è£¹çŠ¶æ€ä¸º "é…é€ä¸­"
   â†“
7. éª‘æ‰‹é€è¾¾ â†’ æ›´æ–°åŒ…è£¹çŠ¶æ€ä¸º "å·²é€è¾¾"
   â†“
8. å®¢æˆ·æ”¶åˆ°é€è¾¾é€šçŸ¥
```

### 2. æ•°æ®åº“è¿æ¥

**æ‰€æœ‰ç»„ä»¶å…±äº«åŒä¸€ä¸ª Supabase æ•°æ®åº“ï¼š**

```typescript
// é…ç½®ä¿¡æ¯ (æ‰€æœ‰ç»„ä»¶ç›¸åŒ)
const supabaseUrl = 'https://uopkyuluxnrewvlmutam.supabase.co';
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...';

export const supabase = createClient(supabaseUrl, supabaseKey);
```

**ä½ç½®ï¼š**
- Web: `src/services/supabase.ts`
- å®¢æˆ·ç«¯APP: `ml-express-client/src/services/supabase.ts`
- å‘˜å·¥APP: `ml-express-mobile-app/services/supabase.ts`

### 3. ç”¨æˆ·èº«ä»½ç³»ç»Ÿ

#### Web ç«¯ç”¨æˆ·
- **å®¢æˆ·**ï¼šé€šè¿‡ `users` è¡¨ç®¡ç†
- **ç®¡ç†å‘˜**ï¼šé€šè¿‡ `admin_accounts` è¡¨ç®¡ç†

#### ç§»åŠ¨ç«¯ç”¨æˆ·
- **å®¢æˆ·ç«¯APP**ï¼šå®¢æˆ·é€šè¿‡ `users` è¡¨ç™»å½•
- **å‘˜å·¥APP**ï¼šå‘˜å·¥é€šè¿‡ `admin_accounts` è¡¨ç™»å½•

#### å…³é”®èº«ä»½åŒ¹é…é€»è¾‘
```typescript
// å‘˜å·¥APPç™»å½•æ—¶ (LoginScreen.tsx)
if (account.position === 'éª‘æ‰‹' || account.position === 'éª‘æ‰‹é˜Ÿé•¿') {
  // æŸ¥æ‰¾å¯¹åº”çš„å¿«é€’å‘˜è®°å½•
  const { data: courierData } = await supabase
    .from('couriers')
    .select('id, name')
    .eq('name', account.employee_name)  // å…³é”®ï¼šä½¿ç”¨ employee_name åŒ¹é…
    .single();
  
  // å­˜å‚¨å¿«é€’å‘˜å§“ååˆ° currentUserName
  await AsyncStorage.setItem('currentUserName', courierData.name);
}

// åŒ…è£¹åˆ†é…æ—¶ (RealTimeTracking.tsx)
const success = await packageService.updatePackageStatus(
  packageData.id,
  'å·²å–ä»¶',
  new Date().toLocaleString('zh-CN'),
  undefined,
  courier.name  // ä½¿ç”¨å¿«é€’å‘˜çš„ name å­—æ®µ
);

// ç§»åŠ¨ç«¯åŒ…è£¹è¿‡æ»¤ (MapScreen.tsx)
const myPackages = allPackages.filter(pkg => 
  pkg.courier === currentUser &&  // currentUser = courierData.name
  !['å·²é€è¾¾', 'å·²å–æ¶ˆ'].includes(pkg.status)
);
```

### 4. æ•°æ®æµè½¬æœºåˆ¶

#### è®¢å•åˆ›å»ºæµç¨‹
```typescript
// 1. å®¢æˆ·æ³¨å†Œ (Web åº”ç”¨)
const newUser = await userService.createCustomer({
  name: customerName,
  phone: customerPhone,
  email: customerEmail,
  address: customerAddress,
  password: customerPassword
});

// 2. å®¢æˆ·ä¸‹å• (Web åº”ç”¨)
const newPackage = await packageService.createPackage({
  sender_name: senderName,
  sender_phone: senderPhone,
  sender_address: senderAddress,
  receiver_name: receiverName,
  receiver_phone: receiverPhone,
  receiver_address: receiverAddress,
  package_type: packageType,
  weight: weight,
  description: `${description} [å®¢æˆ·ID: ${userId}]`, // å…³é”®ï¼šåŒ…å«å®¢æˆ·ID
  delivery_speed: deliverySpeed,
  status: 'å¾…å–ä»¶'
});

// 3. ç”Ÿæˆè®¢å•å·å’ŒäºŒç»´ç 
const orderId = `PKG${Date.now()}${Math.random().toString(36).substr(2, 4).toUpperCase()}`;
const qrCodeData = `è®¢å•å·: ${orderId}\né‡‘é¢: ${totalAmount}\næ—¶é—´: ${new Date().toLocaleString()}`;
```

#### åŒ…è£¹åˆ†é…æµç¨‹
```typescript
// 1. Web ç«¯è‡ªåŠ¨åˆ†é… (RealTimeTracking.tsx)
const autoAssignPackage = async (packageData: Package) => {
  // æ‰¾åˆ°åœ¨çº¿ä¸”åŒ…è£¹æœ€å°‘çš„éª‘æ‰‹
  const availableCouriers = couriers
    .filter(c => c.status === 'online' || c.status === 'active')
    .sort((a, b) => (a.currentPackages || 0) - (b.currentPackages || 0));

  const bestCourier = availableCouriers[0];
  
  // æ›´æ–°åŒ…è£¹çŠ¶æ€
  await packageService.updatePackageStatus(
    packageData.id,
    'å·²å–ä»¶',
    new Date().toLocaleString('zh-CN'),
    undefined,
    bestCourier.name
  );
  
  // å‘é€é€šçŸ¥ç»™éª‘æ‰‹
  await notificationService.sendPackageAssignedNotification(
    bestCourier.id,
    bestCourier.name,
    packageData.id,
    packageData
  );
};

// 2. éª‘æ‰‹ APP æ¥æ”¶ä»»åŠ¡ (MapScreen.tsx)
const loadPackages = async () => {
  const currentUser = await AsyncStorage.getItem('currentUserName');
  const allPackages = await packageService.getAllPackages();
  
  // è¿‡æ»¤å‡ºåˆ†é…ç»™å½“å‰éª‘æ‰‹çš„åŒ…è£¹
  const myPackages = allPackages.filter(pkg => 
    pkg.courier === currentUser && 
    !['å·²é€è¾¾', 'å·²å–æ¶ˆ'].includes(pkg.status)
  );
  
  setPackages(myPackages);
};
```

#### åŒ…è£¹çŠ¶æ€æ›´æ–°æµç¨‹
```typescript
// 1. éª‘æ‰‹å–ä»¶ (å‘˜å·¥ APP)
await packageService.updatePackageStatus(
  packageId,
  'å·²å–ä»¶',
  new Date().toLocaleString('zh-CN'),
  undefined,
  courierName
);

// 2. éª‘æ‰‹å¼€å§‹é…é€ (å‘˜å·¥ APP)
await packageService.updatePackageStatus(
  packageId,
  'é…é€ä¸­',
  undefined,
  undefined,
  courierName
);

// 3. éª‘æ‰‹é€è¾¾ (å‘˜å·¥ APP)
await packageService.updatePackageStatus(
  packageId,
  'å·²é€è¾¾',
  undefined,
  new Date().toLocaleString('zh-CN'),
  courierName
);

// 4. å®¢æˆ·æ”¶åˆ°é€šçŸ¥ (Web åº”ç”¨)
const notification = await notificationService.createNotification({
  user_id: customerId,
  title: 'åŒ…è£¹å·²é€è¾¾',
  message: `æ‚¨çš„åŒ…è£¹ ${packageId} å·²æˆåŠŸé€è¾¾`,
  type: 'delivery_complete'
});
```

---

## ğŸ—ºï¸ Google Maps é›†æˆ

### 1. API Key é…ç½®

#### Web åº”ç”¨ (React)
```typescript
// ç¯å¢ƒå˜é‡é…ç½®
const GOOGLE_MAPS_API_KEY = process.env.REACT_APP_GOOGLE_MAPS_API_KEY || "AIzaSyCYXeFO2DGWHpDhbwOC7fusLyiwLy506_c";

// ä½¿ç”¨æ–¹å¼
const { isLoaded: isMapLoaded } = useJsApiLoader({
  googleMapsApiKey: GOOGLE_MAPS_API_KEY,
  libraries: ['places']
});
```

**é…ç½®æ–‡ä»¶ï¼š**
- `.env`: `REACT_APP_GOOGLE_MAPS_API_KEY=AIzaSyCYXeFO2DGWHpDhbwOC7fusLyiwLy506_c`
- `netlify.toml`: éƒ¨ç½²ç¯å¢ƒå˜é‡é…ç½®

#### ç§»åŠ¨åº”ç”¨ (React Native + Expo)
```json
// app.json é…ç½®
{
  "ios": {
    "config": {
      "googleMapsApiKey": "AIzaSyCYXeFO2DGWHpDhbwOC7fusLyiwLy506_c"
    }
  },
  "android": {
    "config": {
      "googleMaps": {
        "apiKey": "AIzaSyCYXeFO2DGWHpDhbwOC7fusLyiwLy506_c"
      }
    }
  }
}
```

**é…ç½®æ–‡ä»¶ï¼š**
- `ml-express-client/app.json`
- `ml-express-mobile-app/app.json`

### 2. API Key ç®¡ç†ç­–ç•¥

#### å½“å‰ API Key
```
AIzaSyCYXeFO2DGWHpDhbwOC7fusLyiwLy506_c
```

#### éœ€è¦æ›´æ–°çš„ä½ç½®
1. **Web åº”ç”¨**ï¼š
   - `.env` æ–‡ä»¶
   - `vercel.json` æ–‡ä»¶ (Vercel é…ç½®)
   - `netlify.toml` æ–‡ä»¶ (Netlify å¤‡ç”¨)
   - `src/pages/HomePage.tsx` (fallback)
   - `src/pages/RealTimeTracking.tsx` (fallback)
   - `src/pages/TrackingPage.tsx` (fallback)
   - `src/pages/DeliveryStoreManagement.tsx` (LoadScript)

2. **å®¢æˆ·ç«¯APP**ï¼š
   - `ml-express-client/app.json` (iOS & Android)

3. **å‘˜å·¥APP**ï¼š
   - `ml-express-mobile-app/app.json` (iOS & Android)

4. **Vercel éƒ¨ç½²** (ç”Ÿäº§ç¯å¢ƒ)ï¼š
   - ç¯å¢ƒå˜é‡è®¾ç½® (Project Settings â†’ Environment Variables)
   - `vercel.json` é…ç½®æ–‡ä»¶

5. **Netlify éƒ¨ç½²** (å¤‡ç”¨)ï¼š
   - ç¯å¢ƒå˜é‡è®¾ç½® (Site settings â†’ Environment variables)

---

## ğŸš€ éƒ¨ç½²é…ç½®

### 1. Web åº”ç”¨éƒ¨ç½²

#### A. Netlify éƒ¨ç½² (å¤‡ç”¨)

##### æ„å»ºé…ç½® (`netlify.toml`)
```toml
[build]
  command = "npm install && npm run build"
  publish = "build"

[build.environment]
  NODE_VERSION = "18"

# ç¯å¢ƒå˜é‡
[context.production.environment]
  REACT_APP_GOOGLE_MAPS_API_KEY = "AIzaSyCYXeFO2DGWHpDhbwOC7fusLyiwLy506_c"
  REACT_APP_SUPABASE_URL = "YOUR_SUPABASE_URL"
  REACT_APP_SUPABASE_ANON_KEY = "YOUR_SUPABASE_ANON_KEY"

# SPA é‡å®šå‘
[[redirects]]
  from = "/*"
  to = "/index.html"
  status = 200
```

##### éƒ¨ç½² URL
- ç”Ÿäº§ç¯å¢ƒ: `https://market-link-express.netlify.app/`
- é¢„è§ˆç¯å¢ƒ: `https://[deploy-id]--market-link-express.netlify.app/`

#### B. Vercel éƒ¨ç½² (ç”Ÿäº§ç¯å¢ƒ) â­

##### é¡¹ç›®é…ç½®
- **é¡¹ç›®åç§°**: ML Express Production
- **å¹³å°**: Vercel.com
- **æ¡†æ¶**: Create React App
- **Node.js ç‰ˆæœ¬**: 18.x

##### æ„å»ºé…ç½® (`vercel.json`)
```json
{
  "version": 2,
  "builds": [
    {
      "src": "package.json",
      "use": "@vercel/static-build",
      "config": {
        "distDir": "build"
      }
    }
  ],
  "routes": [
    {
      "src": "/static/(.*)",
      "headers": {
        "cache-control": "public, max-age=31536000, immutable"
      }
    },
    {
      "src": "/(.*)",
      "dest": "/index.html"
    }
  ],
  "env": {
    "REACT_APP_GOOGLE_MAPS_API_KEY": "AIzaSyCYXeFO2DGWHpDhbwOC7fusLyiwLy506_c",
    "REACT_APP_SUPABASE_URL": "https://uopkyuluxnrewvlmutam.supabase.co",
    "REACT_APP_SUPABASE_ANON_KEY": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVvcGt5dWx1eG5yZXd2bG11dGFtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkwNDMwMDAsImV4cCI6MjA3NDYxOTAwMH0._6AilDWJcevT-qo90f6wInAKw3aKn2a8jIM8BEGQ3rY"
  }
}
```

##### Vercel ç¯å¢ƒå˜é‡é…ç½®
åœ¨ Vercel Dashboard â†’ Project Settings â†’ Environment Variables ä¸­è®¾ç½®ï¼š

```
REACT_APP_GOOGLE_MAPS_API_KEY = AIzaSyCYXeFO2DGWHpDhbwOC7fusLyiwLy506_c
REACT_APP_SUPABASE_URL = https://uopkyuluxnrewvlmutam.supabase.co
REACT_APP_SUPABASE_ANON_KEY = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InVvcGt5dWx1eG5yZXd2bG11dGFtIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkwNDMwMDAsImV4cCI6MjA3NDYxOTAwMH0._6AilDWJcevT-qo90f6wInAKw3aKn2a8jIM8BEGQ3rY
REACT_APP_APP_NAME = MARKET LINK EXPRESS
REACT_APP_APP_VERSION = 1.0.0
```

##### éƒ¨ç½² URL
- **ç”Ÿäº§ç¯å¢ƒ**: `https://ml-express-production.vercel.app/`
- **é¢„è§ˆç¯å¢ƒ**: `https://ml-express-production-git-[branch].vercel.app/`
- **è‡ªå®šä¹‰åŸŸå**: (å¦‚æœå·²é…ç½®)

##### Vercel éƒ¨ç½²ä¼˜åŠ¿
- âœ… æ›´å¿«çš„å…¨çƒ CDN
- âœ… è‡ªåŠ¨ HTTPS
- âœ… é›¶é…ç½®éƒ¨ç½²
- âœ… é¢„è§ˆåˆ†æ”¯éƒ¨ç½²
- âœ… æ›´å¥½çš„æ€§èƒ½ç›‘æ§

### 2. ç§»åŠ¨åº”ç”¨éƒ¨ç½²

#### å®¢æˆ·ç«¯APP (ml-express-client)
```bash
# å¼€å‘æ¨¡å¼
cd ml-express-client
npm start

# æ„å»º
expo build:android
expo build:ios
```

#### å‘˜å·¥APP (ml-express-mobile-app)
```bash
# å¼€å‘æ¨¡å¼
cd ml-express-mobile-app
npm start

# æ„å»º
expo build:android
expo build:ios
```

---

## ğŸ”§ å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

### 1. Google Maps API Key é—®é¢˜

#### é—®é¢˜ï¼šInvalidKeyMapError
**åŸå› **ï¼šAPI Key æ— æ•ˆæˆ–æœªå¯ç”¨ç›¸åº”æœåŠ¡
**è§£å†³**ï¼š
1. æ£€æŸ¥ Google Cloud Console ä¸­çš„ API Key çŠ¶æ€
2. ç¡®ä¿å¯ç”¨äº†ä»¥ä¸‹ APIï¼š
   - Maps JavaScript API (Web)
   - Maps SDK for Android (Android)
   - Maps SDK for iOS (iOS)
   - Geocoding API (å¯é€‰)

#### é—®é¢˜ï¼šRefererNotAllowedMapError
**åŸå› **ï¼šHTTP referer é™åˆ¶é…ç½®é”™è¯¯
**è§£å†³**ï¼š
1. åœ¨ Google Cloud Console ä¸­æ·»åŠ å…è®¸çš„åŸŸåï¼š
   - `https://market-link-express.netlify.app/*`
   - `https://*.netlify.app/*` (é¢„è§ˆç¯å¢ƒ)
2. ç¡®ä¿ Netlify ç¯å¢ƒå˜é‡æ­£ç¡®è®¾ç½®

### 2. åŒ…è£¹åˆ†é…é—®é¢˜

#### é—®é¢˜ï¼šWeb ç«¯åˆ†é…åï¼Œç§»åŠ¨ç«¯çœ‹ä¸åˆ°åŒ…è£¹
**åŸå› **ï¼šç”¨æˆ·èº«ä»½åŒ¹é…ä¸ä¸€è‡´
**è§£å†³**ï¼š
1. ç¡®ä¿ `admin_accounts.employee_name` ä¸ `couriers.name` ä¸€è‡´
2. æ£€æŸ¥ç§»åŠ¨ç«¯ç™»å½•æ—¶æ˜¯å¦æ­£ç¡®å­˜å‚¨äº†å¿«é€’å‘˜å§“å
3. éªŒè¯åŒ…è£¹çš„ `courier` å­—æ®µæ˜¯å¦æ­£ç¡®æ›´æ–°

#### è°ƒè¯•æ­¥éª¤ï¼š
```typescript
// 1. æ£€æŸ¥ç§»åŠ¨ç«¯å½“å‰ç”¨æˆ·
const currentUser = await AsyncStorage.getItem('currentUserName');
console.log('å½“å‰ç”¨æˆ·:', currentUser);

// 2. æ£€æŸ¥æ‰€æœ‰åŒ…è£¹
const allPackages = await packageService.getAllPackages();
console.log('æ‰€æœ‰åŒ…è£¹:', allPackages);

// 3. æ£€æŸ¥åŒ…è£¹åˆ†é…
const myPackages = allPackages.filter(pkg => 
  pkg.courier === currentUser
);
console.log('æˆ‘çš„åŒ…è£¹:', myPackages);
```

### 3. æ•°æ®åº“è¿æ¥é—®é¢˜

#### é—®é¢˜ï¼šRLS (Row Level Security) é”™è¯¯
**åŸå› **ï¼šè¡Œçº§å®‰å…¨ç­–ç•¥é…ç½®é”™è¯¯
**è§£å†³**ï¼š
1. æ£€æŸ¥ Supabase RLS ç­–ç•¥
2. ç¡®ä¿ç”¨æˆ·æœ‰æ­£ç¡®çš„æƒé™
3. éªŒè¯æ•°æ®è®¿é—®æ¨¡å¼

---

## ğŸ“± ç§»åŠ¨åº”ç”¨æ¶æ„

### 1. å®¢æˆ·ç«¯APP (ml-express-client)

#### ä¸»è¦åŠŸèƒ½
- å®¢æˆ·ä¸‹å•
- åŒ…è£¹è·Ÿè¸ª
- è®¢å•å†å²

#### æŠ€æœ¯æ ˆ
- React Native + Expo
- Supabase å®¢æˆ·ç«¯
- React Native Maps
- AsyncStorage

#### å…³é”®æ–‡ä»¶
- `src/screens/PlaceOrderScreen.tsx` - ä¸‹å•é¡µé¢
- `src/screens/TrackPackageScreen.tsx` - è·Ÿè¸ªé¡µé¢
- `src/services/supabase.ts` - æ•°æ®åº“æœåŠ¡

### 2. å‘˜å·¥APP (ml-express-mobile-app)

#### ä¸»è¦åŠŸèƒ½
- éª‘æ‰‹ç™»å½•
- ä»»åŠ¡ç®¡ç†
- åœ°å›¾å¯¼èˆª
- åŒ…è£¹æ‰«æ

#### æŠ€æœ¯æ ˆ
- React Native + Expo
- Supabase å®¢æˆ·ç«¯
- React Native Maps
- Expo Camera
- AsyncStorage

#### å…³é”®æ–‡ä»¶
- `screens/LoginScreen.tsx` - ç™»å½•é¡µé¢
- `screens/MapScreen.tsx` - åœ°å›¾é¡µé¢ï¼ˆåŒ…å«æ™ºèƒ½è·¯çº¿ä¼˜åŒ–ï¼‰
- `screens/MyTasksScreen.tsx` - ä»»åŠ¡é¡µé¢
- `services/supabase.ts` - æ•°æ®åº“æœåŠ¡

#### ğŸ¯ æ™ºèƒ½é…é€è·¯çº¿ä¼˜åŒ–åŠŸèƒ½ (2025-01-18 æ–°å¢)

**æ ¸å¿ƒç®—æ³•**ï¼š
- **å–è´§ç‚¹åæ ‡è§£æ** - ä¼˜å…ˆä½¿ç”¨`sender_latitude`å’Œ`sender_longitude`
- **é€è´§ç‚¹åæ ‡è§£æ** - ä¼˜å…ˆä½¿ç”¨`receiver_latitude`å’Œ`receiver_longitude`
- **å®Œæ•´è·¯å¾„è®¡ç®—** - è®¡ç®—ä»å½“å‰ä½ç½®åˆ°å–è´§ç‚¹ï¼Œå†åˆ°é€è´§ç‚¹çš„æ€»è·ç¦»
- **æ™ºèƒ½ä¼˜å…ˆçº§æ’åº** - åŸºäºæ€»è·ç¦»å’Œç´§æ€¥ç¨‹åº¦è¿›è¡Œä¼˜åŒ–æ’åº

**åœ°å›¾æ˜¾ç¤ºå¢å¼º**ï¼š
- **å–è´§ç‚¹æ ‡è®°** - æ©™è‰²ğŸ“¦æ ‡è®°æ˜¾ç¤ºæ‰€æœ‰å–è´§ç‚¹ä½ç½®
- **é€è´§ç‚¹æ ‡è®°** - è“è‰²æ•°å­—æ ‡è®°æ˜¾ç¤ºæ‰€æœ‰é€è´§ç‚¹ä½ç½®
- **åˆ†æ®µè·¯çº¿æ˜¾ç¤º** - ä¸‰ç§é¢œè‰²çš„è·¯çº¿ï¼š
  - ğŸŸ¢ **ç»¿è‰²ç²—çº¿** - ä»å½“å‰ä½ç½®åˆ°ç¬¬ä¸€ä¸ªå–è´§ç‚¹
  - ğŸŸ  **æ©™è‰²ä¸­çº¿** - ä»å–è´§ç‚¹åˆ°é€è´§ç‚¹
  - ğŸ”µ **è“è‰²ç»†çº¿** - ä»é€è´§ç‚¹åˆ°ä¸‹ä¸€ä¸ªå–è´§ç‚¹

**åŒ…è£¹å¡ç‰‡ä¼˜åŒ–**ï¼š
- **åˆ†ç¦»å¼ä¿¡æ¯å±•ç¤º** - å–è´§ç‚¹å’Œé€è´§ç‚¹åˆ†åˆ«ç”¨ä¸åŒé¢œè‰²èƒŒæ™¯æ˜¾ç¤º
- **ç»çº¬åº¦ç‹¬ç«‹æ˜¾ç¤º** - ç»çº¬åº¦å•ç‹¬ä¸€è¡Œï¼Œå¸¦æœ‰æ ‡ç­¾è¯´æ˜
- **åœ°å€ç‹¬ç«‹æ˜¾ç¤º** - åœ°å€ä¿¡æ¯å•ç‹¬æ˜¾ç¤ºï¼Œä¾¿äºé˜…è¯»
- **è·ç¦»ä¿¡æ¯è¯¦ç»†** - åˆ†åˆ«æ˜¾ç¤ºå–è´§è·ç¦»ã€é€è´§è·ç¦»å’Œæ€»è·ç¦»

---

## ğŸ—„ï¸ æ•°æ®åº“æ¶æ„

### æ ¸å¿ƒè¡¨ç»“æ„

#### æ•°æ®è¡¨å…³ç³»å›¾
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ•°æ®åº“è¡¨å…³ç³»                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ‘¥ users (å®¢æˆ·è¡¨)                                          â”‚
â”‚     â”œâ”€â”€ id (ä¸»é”®)                                           â”‚
â”‚     â”œâ”€â”€ name, phone, email, address                        â”‚
â”‚     â””â”€â”€ password, created_at                               â”‚
â”‚                                                             â”‚
â”‚  ğŸ“¦ packages (åŒ…è£¹è¡¨)                                       â”‚
â”‚     â”œâ”€â”€ id (ä¸»é”®)                                           â”‚
â”‚     â”œâ”€â”€ sender_*, receiver_* (å‘ä»¶äºº/æ”¶ä»¶äººä¿¡æ¯)            â”‚
â”‚     â”œâ”€â”€ sender_latitude, sender_longitude (å‘ä»¶äººåæ ‡)      â”‚
â”‚     â”œâ”€â”€ receiver_latitude, receiver_longitude (æ”¶ä»¶äººåæ ‡)   â”‚
â”‚     â”œâ”€â”€ description (åŒ…å« [å®¢æˆ·ID: xxx] æ ‡è®°)              â”‚
â”‚     â”œâ”€â”€ courier (å…³è” couriers.name)                        â”‚
â”‚     â”œâ”€â”€ status (å¾…å–ä»¶â†’å·²å–ä»¶â†’é…é€ä¸­â†’å·²é€è¾¾)                â”‚
â”‚     â”œâ”€â”€ delivery_speed (é…é€é€Ÿåº¦: æ€¥é€è¾¾/å®šæ—¶è¾¾)            â”‚
â”‚     â”œâ”€â”€ scheduled_delivery_time (å®šæ—¶é…é€æ—¶é—´)              â”‚
â”‚     â””â”€â”€ pickup_time, delivery_time                         â”‚
â”‚                                                             â”‚
â”‚  ğŸšš couriers (å¿«é€’å‘˜è¡¨)                                     â”‚
â”‚     â”œâ”€â”€ id (ä¸»é”®)                                           â”‚
â”‚     â”œâ”€â”€ name (å…³è” admin_accounts.employee_name)           â”‚
â”‚     â”œâ”€â”€ phone, email, address                              â”‚
â”‚     â”œâ”€â”€ status (active/inactive)                           â”‚
â”‚     â””â”€â”€ last_active, total_deliveries                      â”‚
â”‚                                                             â”‚
â”‚  ğŸ‘¨â€ğŸ’¼ admin_accounts (ç®¡ç†å‘˜è´¦å·è¡¨)                        â”‚
â”‚     â”œâ”€â”€ id (ä¸»é”®)                                           â”‚
â”‚     â”œâ”€â”€ username, password                                 â”‚
â”‚     â”œâ”€â”€ employee_name (å…³è” couriers.name)                 â”‚
â”‚     â”œâ”€â”€ position (éª‘æ‰‹/éª‘æ‰‹é˜Ÿé•¿/ç®¡ç†å‘˜)                     â”‚
â”‚     â””â”€â”€ role, status, last_login                           â”‚
â”‚                                                             â”‚
â”‚  ğŸ“ courier_locations (å¿«é€’å‘˜ä½ç½®è¡¨)                       â”‚
â”‚     â”œâ”€â”€ courier_id (å…³è” couriers.id)                      â”‚
â”‚     â”œâ”€â”€ latitude, longitude                                â”‚
â”‚     â”œâ”€â”€ heading, speed                                     â”‚
â”‚     â””â”€â”€ last_update, battery_level                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### packages (åŒ…è£¹è¡¨)
```sql
CREATE TABLE packages (
  id TEXT PRIMARY KEY,
  sender_name TEXT NOT NULL,
  sender_phone TEXT NOT NULL,
  sender_address TEXT NOT NULL,
  sender_latitude DECIMAL(10,8), -- å‘ä»¶äººçº¬åº¦
  sender_longitude DECIMAL(11,8), -- å‘ä»¶äººç»åº¦
  receiver_name TEXT NOT NULL,
  receiver_phone TEXT NOT NULL,
  receiver_address TEXT NOT NULL,
  receiver_latitude DECIMAL(10,8), -- æ”¶ä»¶äººçº¬åº¦
  receiver_longitude DECIMAL(11,8), -- æ”¶ä»¶äººç»åº¦
  package_type TEXT NOT NULL,
  weight DECIMAL(5,2),
  description TEXT, -- åŒ…å« [å®¢æˆ·ID: xxx] æ ‡è®°
  delivery_speed TEXT NOT NULL, -- é…é€é€Ÿåº¦: æ€¥é€è¾¾/å®šæ—¶è¾¾
  scheduled_delivery_time TEXT, -- å®šæ—¶é…é€æ—¶é—´
  status TEXT NOT NULL DEFAULT 'å¾…å–ä»¶', -- å¾…å–ä»¶â†’å·²å–ä»¶â†’é…é€ä¸­â†’å·²é€è¾¾
  courier TEXT, -- å…³è” couriers.name
  pickup_time TEXT,
  delivery_time TEXT,
  transfer_code TEXT,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

#### couriers (å¿«é€’å‘˜è¡¨)
```sql
CREATE TABLE couriers (
  id TEXT PRIMARY KEY,
  name TEXT NOT NULL, -- å…³è” admin_accounts.employee_name
  phone TEXT NOT NULL,
  email TEXT,
  address TEXT,
  vehicle_type TEXT,
  license_number TEXT,
  status TEXT DEFAULT 'active', -- active/inactive
  join_date TEXT,
  last_active TEXT,
  total_deliveries INTEGER DEFAULT 0,
  rating DECIMAL(3,2) DEFAULT 0,
  notes TEXT,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

#### admin_accounts (ç®¡ç†å‘˜è´¦å·è¡¨)
```sql
CREATE TABLE admin_accounts (
  id TEXT PRIMARY KEY,
  username TEXT UNIQUE NOT NULL,
  password TEXT NOT NULL,
  employee_name TEXT NOT NULL, -- å…³è” couriers.name
  employee_id TEXT UNIQUE NOT NULL,
  phone TEXT NOT NULL,
  email TEXT,
  department TEXT,
  position TEXT, -- éª‘æ‰‹/éª‘æ‰‹é˜Ÿé•¿/ç®¡ç†å‘˜
  role TEXT NOT NULL,
  status TEXT DEFAULT 'active',
  last_login TIMESTAMP,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

#### users (å®¢æˆ·è¡¨)
```sql
CREATE TABLE users (
  id TEXT PRIMARY KEY,
  name TEXT NOT NULL,
  phone TEXT UNIQUE NOT NULL,
  email TEXT,
  address TEXT,
  password TEXT,
  total_orders INTEGER DEFAULT 0,
  total_spent DECIMAL(10,2) DEFAULT 0,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

---

## ğŸ” å®‰å…¨é…ç½®

### 1. API Key å®‰å…¨
- ä½¿ç”¨ç¯å¢ƒå˜é‡å­˜å‚¨æ•æ„Ÿä¿¡æ¯
- åœ¨ Google Cloud Console ä¸­è®¾ç½®é€‚å½“çš„é™åˆ¶
- å®šæœŸè½®æ¢ API Key

### 2. æ•°æ®åº“å®‰å…¨
- å¯ç”¨ Supabase RLS (Row Level Security)
- ä½¿ç”¨é€‚å½“çš„æƒé™ç­–ç•¥
- å®šæœŸå¤‡ä»½æ•°æ®

### 3. éƒ¨ç½²å®‰å…¨
- ä½¿ç”¨ HTTPS
- è®¾ç½®é€‚å½“çš„ CORS ç­–ç•¥
- ç›‘æ§å¼‚å¸¸è®¿é—®

---

## ğŸ“‹ å¼€å‘æ£€æŸ¥æ¸…å•

### æ›´æ–° API Key æ—¶
- [ ] æ›´æ–° `.env` æ–‡ä»¶
- [ ] æ›´æ–° `vercel.json` æ–‡ä»¶ (Vercel ç”Ÿäº§ç¯å¢ƒ)
- [ ] æ›´æ–° `netlify.toml` æ–‡ä»¶ (Netlify å¤‡ç”¨)
- [ ] æ›´æ–°æ‰€æœ‰ Web é¡µé¢çš„ fallback
- [ ] æ›´æ–°å®¢æˆ·ç«¯APPçš„ `app.json`
- [ ] æ›´æ–°å‘˜å·¥APPçš„ `app.json`
- [ ] æ›´æ–° Vercel ç¯å¢ƒå˜é‡ (ç”Ÿäº§ç¯å¢ƒ)
- [ ] æ›´æ–° Netlify ç¯å¢ƒå˜é‡ (å¤‡ç”¨)
- [ ] æµ‹è¯•æ‰€æœ‰åœ°å›¾åŠŸèƒ½
- [ ] éªŒè¯ Vercel éƒ¨ç½²æ˜¯å¦æˆåŠŸ
- [ ] éªŒè¯ Netlify éƒ¨ç½²æ˜¯å¦æˆåŠŸ

### ä¿®å¤åŒ…è£¹åˆ†é…é—®é¢˜æ—¶
- [ ] æ£€æŸ¥ `admin_accounts.employee_name` ä¸ `couriers.name` æ˜¯å¦ä¸€è‡´
- [ ] éªŒè¯ç§»åŠ¨ç«¯ç™»å½•é€»è¾‘
- [ ] æ£€æŸ¥åŒ…è£¹çŠ¶æ€æ›´æ–°
- [ ] æµ‹è¯• Web ç«¯åˆ†é…åŠŸèƒ½
- [ ] éªŒè¯ç§»åŠ¨ç«¯åŒ…è£¹æ˜¾ç¤º

### éƒ¨ç½²å‰æ£€æŸ¥
- [ ] æ‰€æœ‰ API Key é…ç½®æ­£ç¡®
- [ ] æ•°æ®åº“è¿æ¥æ­£å¸¸
- [ ] Vercel ç¯å¢ƒå˜é‡è®¾ç½®å®Œæ•´
- [ ] Netlify ç¯å¢ƒå˜é‡è®¾ç½®å®Œæ•´ (å¤‡ç”¨)
- [ ] `vercel.json` é…ç½®æ–‡ä»¶æ­£ç¡®
- [ ] `netlify.toml` é…ç½®æ–‡ä»¶æ­£ç¡®
- [ ] æ„å»ºæ— é”™è¯¯
- [ ] åŠŸèƒ½æµ‹è¯•é€šè¿‡
- [ ] Vercel éƒ¨ç½²æˆåŠŸ
- [ ] Netlify éƒ¨ç½²æˆåŠŸ (å¤‡ç”¨)

---

## ğŸ†˜ ç´§æ€¥ä¿®å¤æŒ‡å—

### Google Maps å®Œå…¨å¤±æ•ˆ
1. **ç«‹å³æ£€æŸ¥**ï¼š
   - Google Cloud Console API Key çŠ¶æ€
   - è®¡è´¹è´¦æˆ·æ˜¯å¦å¯ç”¨
   - API æœåŠ¡æ˜¯å¦å¯ç”¨

2. **å¿«é€Ÿä¿®å¤**ï¼š
   - æ›´æ–°æ‰€æœ‰é…ç½®æ–‡ä»¶ä¸­çš„ API Key
   - é‡æ–°éƒ¨ç½² Web åº”ç”¨
   - é‡æ–°æ„å»ºç§»åŠ¨åº”ç”¨

3. **éªŒè¯ä¿®å¤**ï¼š
   - è®¿é—® Web åº”ç”¨åœ°å›¾é¡µé¢
   - æµ‹è¯•ç§»åŠ¨åº”ç”¨åœ°å›¾åŠŸèƒ½
   - æ£€æŸ¥æ§åˆ¶å°é”™è¯¯ä¿¡æ¯

### åŒ…è£¹åˆ†é…å®Œå…¨å¤±æ•ˆ
1. **ç«‹å³æ£€æŸ¥**ï¼š
   - æ•°æ®åº“è¿æ¥çŠ¶æ€
   - ç”¨æˆ·èº«ä»½åŒ¹é…é€»è¾‘
   - åŒ…è£¹çŠ¶æ€æ›´æ–°

2. **å¿«é€Ÿä¿®å¤**ï¼š
   - æ£€æŸ¥ `LoginScreen.tsx` ä¸­çš„èº«ä»½å­˜å‚¨é€»è¾‘
   - éªŒè¯ `RealTimeTracking.tsx` ä¸­çš„åˆ†é…é€»è¾‘
   - æµ‹è¯•ç§»åŠ¨ç«¯åŒ…è£¹è¿‡æ»¤

3. **éªŒè¯ä¿®å¤**ï¼š
   - Web ç«¯åˆ†é…åŒ…è£¹
   - ç§»åŠ¨ç«¯æŸ¥çœ‹ä»»åŠ¡åˆ—è¡¨
   - æ£€æŸ¥æ•°æ®åº“ä¸­çš„åŒ…è£¹çŠ¶æ€

---

## ğŸ“ è”ç³»ä¿¡æ¯

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š
1. å…·ä½“çš„é”™è¯¯ä¿¡æ¯
2. å‡ºç°é—®é¢˜çš„é¡µé¢/åŠŸèƒ½
3. æµè§ˆå™¨/è®¾å¤‡ä¿¡æ¯
4. æ§åˆ¶å°é”™è¯¯æ—¥å¿—
5. ç›¸å…³çš„é…ç½®æ–‡ä»¶å†…å®¹

---

## ğŸ—ï¸ å½“å‰ç³»ç»Ÿæ¶æ„ä¸è¿æ¥æ–¹å¼ (2025å¹´1æœˆæ›´æ–°)

### ğŸ“ éƒ¨ç½²æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    MARKET LINK EXPRESS                      â”‚
â”‚                    å½“å‰ç”Ÿäº§ç¯å¢ƒæ¶æ„                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸŒ Web ç®¡ç†åå° (React + TypeScript)                      â”‚
â”‚     â”œâ”€â”€ ä¸»è¦éƒ¨ç½²: Netlify                                   â”‚
â”‚     â”‚   â””â”€â”€ URL: https://market-link-express.netlify.app   â”‚
â”‚     â”œâ”€â”€ å¤‡ç”¨éƒ¨ç½²: Vercel                                    â”‚
â”‚     â”‚   â””â”€â”€ URL: https://ml-express.vercel.app             â”‚
â”‚     â””â”€â”€ ä»£ç ä»“åº“: GitHub (è‡ªåŠ¨éƒ¨ç½²)                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“± å®¢æˆ·ç«¯ APP (React Native + Expo)                       â”‚
â”‚     â”œâ”€â”€ å¼€å‘çŠ¶æ€: å¼€å‘ä¸­                                    â”‚
â”‚     â”œâ”€â”€ éƒ¨ç½²æ–¹å¼: Expo EAS Build                           â”‚
â”‚     â””â”€â”€ åŒ…å: com.marketlinkexpress.client                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸšš å‘˜å·¥ APP (React Native + Expo)                         â”‚
â”‚     â”œâ”€â”€ å¼€å‘çŠ¶æ€: å¼€å‘ä¸­                                    â”‚
â”‚     â”œâ”€â”€ éƒ¨ç½²æ–¹å¼: Expo EAS Build                           â”‚
â”‚     â””â”€â”€ åŒ…å: com.marketlinkexpress.staff                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ—„ï¸ æ•°æ®åº“ (Supabase PostgreSQL)                          â”‚
â”‚     â”œâ”€â”€ é¡¹ç›®: ML Express Production                        â”‚
â”‚     â”œâ”€â”€ URL: https://uopkyuluxnrewvlmutam.supabase.co     â”‚
â”‚     â”œâ”€â”€ ä¸»è¦è¡¨: packages, couriers, users, admin_accounts  â”‚
â”‚     â””â”€â”€ å®æ—¶åŒæ­¥: Web â†” Mobile Apps                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ—ºï¸ åœ°å›¾æœåŠ¡ (Google Maps API)                            â”‚
â”‚     â”œâ”€â”€ API Key: AIzaSyCYXeFO2DGWHpDhbwOC7fusLyiwLy506_c  â”‚
â”‚     â”œâ”€â”€ æœåŠ¡: Maps JavaScript API, Places API, Geocoding   â”‚
â”‚     â””â”€â”€ é™åˆ¶: HTTP referer (Netlify/Vercel domains)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”— ç³»ç»Ÿè¿æ¥æ–¹å¼

#### 1. Web â†” æ•°æ®åº“è¿æ¥
```typescript
// src/services/supabase.ts
const supabaseUrl = 'https://uopkyuluxnrewvlmutam.supabase.co';
const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...';

export const supabase = createClient(supabaseUrl, supabaseKey);
```

#### 2. Mobile Apps â†” æ•°æ®åº“è¿æ¥
```typescript
// ml-express-mobile-app/services/supabase.ts
// ä½¿ç”¨ç›¸åŒçš„ Supabase é…ç½®
```

#### 3. Web â†” Google Maps é›†æˆ
```typescript
// src/pages/HomePage.tsx
const GOOGLE_MAPS_API_KEY = 'AIzaSyCYXeFO2DGWHpDhbwOC7fusLyiwLy506_c';

// åœ°å›¾åæ ‡ä¿å­˜é€»è¾‘ (å·²ä¿®å¤)
const finalCoords = selectedLocation 
  ? { lat: selectedLocation.lat, lng: selectedLocation.lng }
  : mapClickPosition;

if (finalCoords) {
  if (mapSelectionType === 'sender') {
    setSelectedSenderLocation(finalCoords);
  } else if (mapSelectionType === 'receiver') {
    setSelectedReceiverLocation(finalCoords);
  }
}
```

#### 4. Mobile Apps â†” Google Maps é›†æˆ
```typescript
// ml-express-mobile-app/screens/MapScreen.tsx
// ä½¿ç”¨ç›¸åŒçš„ API Keyï¼Œé€šè¿‡ç¯å¢ƒå˜é‡é…ç½®
```

### ğŸš€ éƒ¨ç½²æµç¨‹

#### Web åº”ç”¨éƒ¨ç½² (Netlify)
1. **è‡ªåŠ¨éƒ¨ç½²**ï¼š
   ```bash
   git push origin main
   # Netlify è‡ªåŠ¨æ£€æµ‹ GitHub æ¨é€ï¼Œè§¦å‘æ„å»º
   ```

2. **æ‰‹åŠ¨éƒ¨ç½²**ï¼š
   ```bash
   npm run build
   # å°† build/ ç›®å½•ä¸Šä¼ åˆ° Netlify
   ```

3. **ç¯å¢ƒå˜é‡é…ç½®**ï¼š
   ```toml
   # netlify.toml
   [context.production.environment]
   REACT_APP_GOOGLE_MAPS_API_KEY = "AIzaSyCYXeFO2DGWHpDhbwOC7fusLyiwLy506_c"
   REACT_APP_SUPABASE_URL = "https://uopkyuluxnrewvlmutam.supabase.co"
   REACT_APP_SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
   ```

#### Mobile Apps éƒ¨ç½² (Expo EAS Build)
1. **Android éƒ¨ç½²**ï¼š
   ```bash
   cd ml-express-mobile-app
   eas build --platform android --profile production
   ```

2. **iOS éƒ¨ç½²**ï¼š
   ```bash
   cd ml-express-mobile-app
   eas build --platform ios --profile production
   ```

### ğŸ”§ å…³é”®ä¿®å¤è®°å½•

#### 1. åœ°å›¾åæ ‡ä¿å­˜ä¿®å¤ (2025-01-18)
**é—®é¢˜**ï¼šWeb ç«¯ä¸‹å•æ—¶ï¼Œåœ°å›¾é€‰æ‹©çš„åæ ‡æ²¡æœ‰æ­£ç¡®ä¿å­˜åˆ°æ•°æ®åº“
**ä¿®å¤**ï¼š
- ä¿®å¤ `HomePage.tsx` ä¸­åœ°å›¾ç¡®è®¤æŒ‰é’®çš„åæ ‡è·å–é€»è¾‘
- ä¼˜å…ˆä½¿ç”¨ `selectedLocation` (POIç‚¹å‡») çš„åæ ‡
- ç¡®ä¿ `receiver_latitude/longitude` æ­£ç¡®ä¿å­˜åˆ° Supabase

#### 2. éª‘æ‰‹ App å¯¼èˆªä¸€è‡´æ€§ä¿®å¤ (2025-01-18)
**é—®é¢˜**ï¼šéª‘æ‰‹ App å¯¼èˆªç›®çš„åœ°ä¸å®¢æˆ·ä¸‹å•ä½ç½®ä¸ä¸€è‡´
**ä¿®å¤**ï¼š
- ä¼˜åŒ– `MapScreen.tsx` ä¸­çš„ `handleNavigate` å‡½æ•°
- ç›´æ¥ä½¿ç”¨æ•°æ®åº“æä¾›çš„ç²¾ç¡®åæ ‡
- å¦‚æœåæ ‡ç¼ºå¤±ï¼Œæç¤ºç®¡ç†å‘˜è¡¥å…¨è€Œéä½¿ç”¨ fallback geocoding

#### 4. éª‘æ‰‹Appæ™ºèƒ½è·¯çº¿ä¼˜åŒ– (2025-01-18)
**åŠŸèƒ½**ï¼šä¼˜åŒ–éª‘æ‰‹appé…é€è·¯çº¿ç®—æ³•ï¼Œç¡®ä¿å–è´§ç‚¹å’Œé€è´§ç‚¹éƒ½æŒ‰æœ€è¿‘è·¯ç¨‹è§„åˆ’
**å®ç°**ï¼š
- æ–°å¢`getPickupCoordinates`å’Œ`getDeliveryCoordinates`å‡½æ•°
- å®ç°å®Œæ•´è·¯å¾„è®¡ç®—ï¼ˆå½“å‰ä½ç½®â†’å–è´§ç‚¹â†’é€è´§ç‚¹ï¼‰
- ä¼˜åŒ–åœ°å›¾æ˜¾ç¤ºï¼šå–è´§ç‚¹æ©™è‰²ğŸ“¦æ ‡è®°ï¼Œé€è´§ç‚¹è“è‰²æ•°å­—æ ‡è®°
- åˆ†æ®µè·¯çº¿æ˜¾ç¤ºï¼šç»¿è‰²ï¼ˆåˆ°å–è´§ç‚¹ï¼‰ã€æ©™è‰²ï¼ˆå–è´§åˆ°é€è´§ï¼‰ã€è“è‰²ï¼ˆé€è´§åˆ°ä¸‹ä¸€å–è´§ç‚¹ï¼‰
- åŒ…è£¹å¡ç‰‡ä¼˜åŒ–ï¼šåˆ†ç¦»å¼ä¿¡æ¯å±•ç¤ºï¼Œç»çº¬åº¦ç‹¬ç«‹æ˜¾ç¤º

#### 5. åŒ…è£¹å¡ç‰‡æ˜¾ç¤ºä¼˜åŒ– (2025-01-18)
**åŠŸèƒ½**ï¼šä¼˜åŒ–éª‘æ‰‹appåœ°å›¾é¡µé¢åŒ…è£¹å¡ç‰‡æ˜¾ç¤ºï¼Œå°†ç»çº¬åº¦å’Œåœ°å€åˆ†å¼€æ˜¾ç¤º
**å®ç°**ï¼š
- å–è´§ç‚¹åŒºåŸŸï¼šé»„è‰²èƒŒæ™¯ + æ©™è‰²å·¦è¾¹æ¡†
- é€è´§ç‚¹åŒºåŸŸï¼šè“è‰²èƒŒæ™¯ + è“è‰²å·¦è¾¹æ¡†
- ç»çº¬åº¦å®¹å™¨ï¼šåŠé€æ˜ç™½è‰²èƒŒæ™¯ï¼Œçªå‡ºæ˜¾ç¤ºåæ ‡
- è·ç¦»ä¿¡æ¯ï¼šåˆ†åˆ«æ˜¾ç¤ºå–è´§è·ç¦»ã€é€è´§è·ç¦»å’Œæ€»è·ç¦»
- æé«˜æ“ä½œä¾¿åˆ©æ€§ï¼šç»çº¬åº¦ç‹¬ç«‹æ˜¾ç¤ºï¼Œä¾¿äºå¤åˆ¶å’Œä½¿ç”¨

### ğŸ“Š æ•°æ®æµæ¶æ„

```
å®¢æˆ·ä¸‹å•æµç¨‹:
Web HomePage â†’ Google Maps API â†’ åæ ‡é€‰æ‹© â†’ Supabase packages è¡¨
                â†“
å®æ—¶è·Ÿè¸ªé¡µé¢ â†’ åŒ…è£¹åˆ†é… â†’ é€šçŸ¥ç³»ç»Ÿ â†’ éª‘æ‰‹ App æ¥æ”¶

éª‘æ‰‹é…é€æµç¨‹:
éª‘æ‰‹ App â†’ ç™»å½•éªŒè¯ â†’ ä»»åŠ¡åˆ—è¡¨ â†’ åœ°å›¾å¯¼èˆª â†’ çŠ¶æ€æ›´æ–° â†’ Web ç®¡ç†åå°
```

### ğŸ” å®‰å…¨é…ç½®

#### Google Maps API Key é™åˆ¶
- **HTTP referer é™åˆ¶**ï¼š
  - `https://market-link-express.netlify.app/*`
  - `https://ml-express.vercel.app/*`
  - `https://*.netlify.app/*` (é¢„è§ˆç¯å¢ƒ)

#### Supabase RLS ç­–ç•¥
- **packages è¡¨**ï¼šå…è®¸ `anon` è§’è‰²è¿›è¡Œæ‰€æœ‰æ“ä½œ
- **couriers è¡¨**ï¼šé™åˆ¶è®¿é—®æƒé™
- **admin_accounts è¡¨**ï¼šç®¡ç†å‘˜ä¸“ç”¨

### ğŸ“± ç§»åŠ¨ç«¯é…ç½®

#### ç¯å¢ƒå˜é‡
```bash
# ml-express-mobile-app/.env
EXPO_PUBLIC_GOOGLE_MAPS_API_KEY=AIzaSyCYXeFO2DGWHpDhbwOC7fusLyiwLy506_c
EXPO_PUBLIC_SUPABASE_URL=https://uopkyuluxnrewvlmutam.supabase.co
EXPO_PUBLIC_SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
```

#### æƒé™é…ç½®
```json
// ml-express-mobile-app/app.json
{
  "expo": {
    "permissions": [
      "ACCESS_FINE_LOCATION",
      "ACCESS_COARSE_LOCATION",
      "CAMERA",
      "MEDIA_LIBRARY"
    ]
  }
}
```

---

*æœ€åæ›´æ–°ï¼š2025å¹´1æœˆ18æ—¥*
*ç‰ˆæœ¬ï¼š2.1.0*
*çŠ¶æ€ï¼šç”Ÿäº§ç¯å¢ƒè¿è¡Œä¸­*
*æ–°å¢åŠŸèƒ½ï¼šéª‘æ‰‹Appæ™ºèƒ½è·¯çº¿ä¼˜åŒ– + åŒ…è£¹å¡ç‰‡æ˜¾ç¤ºä¼˜åŒ–*
