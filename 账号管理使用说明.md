# 账号管理系统使用说明

## 📋 功能概述

新增的账号管理系统允许你创建和管理员工登录账号，所有新建的账号都可以在登录页面正常登录。

## 🗄️ 数据库设置

### 第一步：执行SQL脚本

在 Supabase SQL 编辑器中执行 `supabase-admin-accounts-setup.sql` 文件：

1. 登录 Supabase Dashboard
2. 进入项目的 SQL Editor
3. 复制 `supabase-admin-accounts-setup.sql` 的内容
4. 点击 "RUN" 执行

该脚本会：
- ✅ 创建 `admin_accounts` 表
- ✅ 创建必要的索引
- ✅ 设置行级安全策略
- ✅ 插入默认管理员账号（admin/admin）

## 🚀 使用方法

### 访问账号管理页面

有两种方式进入账号管理：

1. **从系统设置进入**：
   - 点击管理后台的"系统设置"
   - 在左侧菜单找到"👥 新增账号"按钮
   - 点击进入账号管理页面

2. **直接访问**：
   - URL: `http://你的域名/admin/accounts`

### 新增员工账号

1. 点击"+ 新增账号"按钮
2. 填写必填信息：
   - **用户名**：登录时使用的用户名
   - **密码**：登录密码
   - **员工姓名**：真实姓名
   - **员工编号**：唯一编号（如 EMP002）
   - **手机号码**：联系电话
   - **邮箱地址**：工作邮箱
   - **部门**：所属部门
   - **职位**：职位名称
   - **角色权限**：选择权限级别
     - 操作员 (Operator)
     - 经理 (Manager)
     - 财务 (Finance)
     - 管理员 (Admin)
   - **入职日期**：员工入职时间

3. 可选信息：
   - 身份证号
   - 紧急联系人
   - 紧急联系电话
   - 住址
   - 备注

4. 点击"创建账号"完成

### 管理现有账号

在账号列表中可以：
- 📋 查看所有账号信息
- ✏️ 修改账号状态（在职/离职/停用）
- 👁️ 查看账号详情
- 📊 查看最后登录时间

## 🔐 登录验证

### 登录流程

1. 访问登录页面：`/admin/login`
2. 输入用户名和密码
3. 系统会：
   - 首先在数据库中验证
   - 验证成功后保存用户信息
   - 自动跳转到管理后台
   - 如果数据库验证失败，回退到硬编码验证（兼容模式）

### 账号状态检查

- ✅ **在职 (active)**：可以正常登录
- ❌ **离职 (inactive)**：无法登录
- ❌ **停用 (suspended)**：无法登录

## 📊 员工信息字段

### 基础信息
- 用户名（登录用）
- 密码
- 员工姓名
- 员工编号

### 联系方式
- 手机号码
- 邮箱地址
- 住址

### 职位信息
- 部门
- 职位
- 角色权限
- 入职日期

### 紧急联系
- 紧急联系人
- 紧急联系电话

### 其他
- 身份证号
- 备注信息

## 🔒 安全特性

1. **密码存储**：目前为明文存储（建议后续加密）
2. **状态验证**：只有状态为"在职"的账号可以登录
3. **登录记录**：自动记录最后登录时间
4. **权限管理**：支持4种角色权限级别

## 💡 使用建议

1. **唯一性要求**：
   - 用户名必须唯一
   - 员工编号必须唯一

2. **密码管理**：
   - 建议使用强密码
   - 定期更换密码
   - 离职员工及时停用账号

3. **信息完整性**：
   - 尽量填写完整的员工信息
   - 紧急联系信息很重要
   - 备注栏可记录特殊说明

## 🐛 常见问题

### Q: 创建账号失败？
A: 检查用户名或员工编号是否已存在

### Q: 无法登录？
A: 确认账号状态是否为"在职"

### Q: 忘记密码怎么办？
A: 联系管理员在数据库中重置密码

## 📝 后续改进建议

- [ ] 密码加密存储
- [ ] 密码找回功能
- [ ] 详细权限控制
- [ ] 操作日志记录
- [ ] 批量导入员工
- [ ] Excel 导出功能
